📋 팀 대항전 대시보드 — 운영 가이드

▸ 전체 구조
	이 스프레드시트는 3개 레이어로 구성되어 있다.
	① 과제 폼 (기수별 별도 스프레드시트)	Google Forms 응답이 쌓이는 원본
	② 과제 폼 가져오기 (이 파일 내 시트)	IMPORTRANGE로 ①의 데이터를 가져오는 중간 레이어
	③ 점수 집계 (이 파일 내 시트)	②를 기반으로 팀별 점수를 자동 계산
	④ 대시보드 (index.html)	③을 읽어서 웹에서 시각화

▸ 기수가 바뀔 때
	새 기수 → 새 Google Form → 새 응답 시트가 생긴다.
	"과제 폼 가져오기" 시트의 IMPORTRANGE URL만 새 주소로 교체하면 끝.
	점수 집계 수식, 대시보드 코드는 수정 불필요.
	→ IMPORTRANGE를 중간 레이어로 둔 이유: 폼이 바뀌어도 집계 로직은 그대로 유지된다.

▸ 점수 집계 수식 설계
	핵심 수식 (C2 기준):
	=IF(COUNTA('과제 폼 가져오기'!$C$2:$C)=0, 0, SUMPRODUCT(('과제 폼 가져오기'!$C$2:$C<>"")*('과제 폼 가져오기'!$E$2:$E=$A2)*ISNUMBER(SEARCH((COLUMN()-2)&"주차", '과제 폼 가져오기'!$F$2:$F))*(HOUR('과제 폼 가져오기'!$A$2:$A+9/24)<23)))

	구성 요소	설명
	COUNTA(...)=0	제출 데이터가 하나도 없으면 0 반환 (빈 시트 방어)
	SUMPRODUCT(...)	이름 비어있지 않음 × 팀 일치 × 해당 주차 포함 × 시간 필터 → 4가지 조건으로 집계
	$A2	아래로 복사 시 팀명 자동 변경 (A→B→C...)
	COLUMN()-2	오른쪽으로 복사 시 주차 자동 변경 (1→2→3)
	+9/24	원본 폼 시트가 Etc/GMT(UTC)이므로 KST 변환을 위해 9시간 보정
	HOUR(...)<23	KST 기준 오후 11시(23시) 이전 제출만 인정
	→ C2 하나만 작성하고 C2:E7로 드래그하면 전체 적용

	⚠️ FILTER + ISNUMBER(SEARCH()) 조합은 IMPORTRANGE 데이터와 함께 쓸 때
	빈 셀 처리가 비정상 동작하는 Google Sheets 버그가 있음. COUNTIFS 대신 SUMPRODUCT를 쓰는 이유.
	⚠️ 원본 폼 응답 시트의 타임존이 Etc/GMT(UTC)이므로, 타임스탬프에 +9/24 보정 필수.

▸ 자동 갱신 설정
	IMPORTRANGE는 기본적으로 자동 갱신되지만 지연될 수 있다.
	설정 방법: 파일 > 설정 > 계산 > 재계산 → "변경 시 및 매분"
	그래도 안 되면: 확장 프로그램 > Apps Script에서 트리거로 강제 갱신 가능

▸ 트러블슈팅
	문제	확인 사항
	제출했는데 점수 미반영	"과제 폼 가져오기" 시트에 해당 응답이 보이는지 확인. 안 보이면 IMPORTRANGE 갱신 문제.
	특정 팀만 점수 이상	폼 응답의 "팀" 값이 점수 집계의 팀명(A, B, C, D, E, F)과 정확히 일치하는지 확인.
	대시보드 미반영	점수 집계가 정상인데 대시보드가 안 바뀌면, 시트의 "웹에 게시" 설정 확인.
